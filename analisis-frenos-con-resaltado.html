<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An치lisis de Frenos - Sistema Judicial</title>
    <link rel="stylesheet" href="https://cdn.tailwindcss.com/3.3.3/tailwind.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hammer.js@2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.2/package/dist/xlsx.full.min.js"></script>
    <style>
        canvas { width: 100%; height: 200px; }
        .chart-container { position: relative; width: 100%; height: 300px; overflow-x: auto; }
        .bubble { transition: transform 0.1s ease-out; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-button { @apply bg-gray-200 px-4 py-2 rounded-t-lg; }
        .tab-button.active { @apply bg-white border-b-2 border-blue-500; }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <div class="container mx-auto p-4">
        <header class="text-center mb-6">
            <h1 class="text-2xl font-bold">An치lisis de Frenos - Sistema Judicial</h1>
            <p class="text-sm">Versi칩n 1.0.0</p>
        </header>

        <!-- Pesta침as -->
        <div class="flex border-b mb-4">
            <button class="tab-button active" onclick="showTab('nivel')">Nivel</button>
            <button class="tab-button" onclick="showTab('coeficiente')">Coeficiente de Rozamiento</button>
            <button class="tab-button" onclick="showTab('reaccion')">Tiempo de Reacci칩n</button>
        </div>

        <!-- Nivelaci칩n -->
        <section id="nivel" class="tab-content active bg-white p-4 rounded-lg shadow mb-6">
            <h2 class="text-lg font-semibold mb-2">Nivel</h2>
            <canvas id="levelCanvas" class="border border-gray-300"></canvas>
            <p class="text-center mt-2 text-sm">Alinea el dispositivo hasta que la burbuja est칠 centrada en la cruceta</p>
        </section>

        <!-- An치lisis del Coeficiente de Rozamiento -->
        <section id="coeficiente" class="tab-content bg-white p-4 rounded-lg shadow mb-6">
            <h2 class="text-lg font-semibold mb-2">An치lisis del Coeficiente de Rozamiento (풮)</h2>
            <div class="mb-4">
                <label class="block text-sm">N칰mero de diligencias:</label>
                <input type="text" id="diligenciasMu" class="w-full p-2 border rounded">
                <label class="block text-sm mt-2">Matr칤cula:</label>
                <input type="text" id="matriculaMu" class="w-full p-2 border rounded">
            </div>
            <div class="flex space-x-2 mb-4">
                <button id="startRecording" class="bg-blue-500 text-white px-4 py-2 rounded">Iniciar Grabaci칩n</button>
                <button id="stopRecording" class="bg-red-500 text-white px-4 py-2 rounded" disabled>Detener Grabaci칩n</button>
            </div>
            <p id="recordingStatus" class="text-sm">Estado: No grabando</p>
            <p id="gpsStatus" class="text-sm">Estado GPS: 游늸 Esperando se침al</p>
            <p id="gpsCoords" class="text-sm">Coordenadas: N/A</p>
            <p id="gpsSpeed" class="text-sm">Velocidad GPS: 0.0 km/h</p>
            <p id="gpsAccuracy" class="text-sm">Precisi칩n GPS: N/A</p>
            <p id="gpsPoints" class="text-sm">Puntos GPS: 0</p>
            <div class="chart-container">
                <canvas id="accelChart"></canvas>
            </div>
            <table class="w-full text-sm mt-4">
                <tr><th>Eje X</th><td id="accelX">0</td></tr>
                <tr><th>Eje Y</th><td id="accelY">0</td></tr>
                <tr><th>Eje Z</th><td id="accelZ">0</td></tr>
                <tr><th>Velocidad</th><td id="speed">0</td></tr>
            </table>
            <p class="text-sm mt-2">풮 Autom치tico: <span id="muAuto">0.000</span></p>
            <p class="text-sm">풮 Manual: <span id="muManual">0.000</span></p>
            <p class="text-sm">Selecci칩n: Haga clic en la gr치fica para seleccionar el tramo</p>
            <div class="flex space-x-2 mt-4">
                <button id="exportAccelCSV" class="bg-green-500 text-white px-4 py-2 rounded">Exportar Datos Aceler칩metro (CSV)</button>
                <button id="exportGPSCSV" class="bg-green-500 text-white px-4 py-2 rounded">Exportar Datos GPS (CSV)</button>
                <button id="exportPDF" class="bg-purple-500 text-white px-4 py-2 rounded">Generar Informe PDF</button>
                <button id="exportExcel" class="bg-teal-500 text-white px-4 py-2 rounded">Generar Informe Excel</button>
            </div>
            <p class="text-sm mt-2">Datos certificados por An치lisis de Frenos | Hash: <span id="dataHash">N/A</span></p>
            <div class="mt-4">
                <label><input type="radio" name="muMode" value="auto" checked> C치lculo Autom치tico de 풮</label>
                <label><input type="radio" name="muMode" value="manual"> Selecci칩n Manual de Tramo</label>
            </div>
        </section>

        <!-- Ensayo de Tiempo de Reacci칩n -->
        <section id="reaccion" class="tab-content bg-white p-4 rounded-lg shadow mb-6">
            <h2 class="text-lg font-semibold mb-2">Ensayo de Tiempo de Reacci칩n</h2>
            <div class="mb-4">
                <label class="block text-sm">N칰mero de diligencias:</label>
                <input type="text" id="diligenciasReaction" class="w-full p-2 border rounded">
                <label class="block text-sm mt-2">Matr칤cula:</label>
                <input type="text" id="matriculaReaction" class="w-full p-2 border rounded">
            </div>
            <div class="grid grid-cols-2 gap-2 mb-4">
                <div id="light1" class="h-8 bg-red-500 rounded"></div>
                <div id="light2" class="h-8 bg-red-500 rounded"></div>
            </div>
            <button id="startReactionTest" class="bg-blue-500 text-white px-4 py-2 rounded">Iniciar Ensayo</button>
            <button id="exportReactionPDF" class="bg-purple-500 text-white px-4 py-2 rounded mt-2">Exportar Informe PDF</button>
            <button id="exportReactionExcel" class="bg-teal-500 text-white px-4 py-2 rounded mt-2">Exportar Informe Excel</button>
            <p class="text-sm mt-2">Prep치rate para interactuar cuando las luces se apaguen</p>
            <p class="text-sm mt-2">Datos certificados por An치lisis de Frenos | Hash: <span id="reactionHash">N/A</span></p>
        </section>

        <!-- Instrucciones -->
        <section class="bg-white p-4 rounded-lg shadow">
            <h2 class="text-lg font-semibold mb-2">Bienvenido al Sistema de An치lisis de Frenos</h2>
            <p class="text-sm">Esta aplicaci칩n realiza ensayos precisos para determinar el coeficiente de rozamiento (풮) y el tiempo de reacci칩n, dise침ada para uso en procedimientos judiciales.</p>
            <p class="text-sm mt-2">Instrucciones:</p>
            <ul class="text-sm list-disc pl-5">
                <li>En "Nivel", alinee el dispositivo hasta que la burbuja est칠 centrada en la cruceta (recomendado, pero no obligatorio).</li>
                <li>En "Coeficiente de Rozamiento", inicie la grabaci칩n para capturar datos de frenado. Deslice la gr치fica para ver m치s datos o use dos dedos para ajustar el rango.</li>
                <li>En "Tiempo de Reacci칩n", realice el ensayo tocando la pantalla tras el apagado de las luces.</li>
                <li>Exporte los datos en CSV, PDF o Excel para su uso en informes judiciales.</li>
            </ul>
            <button id="understood" class="bg-blue-500 text-white px-4 py-2 rounded mt-4">Entendido</button>
        </section>
    </div>

    <script>
        // Gesti칩n de pesta침as
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`button[onclick="showTab('${tabId}')"]`).classList.add('active');
        }

        // Leveling System
        const levelCanvas = document.getElementById('levelCanvas');
        const levelCtx = levelCanvas.getContext('2d');
        let bubbleX = levelCanvas.width / 2;
        let bubbleY = levelCanvas.height / 2;

        function drawLevel() {
            levelCanvas.width = levelCanvas.clientWidth;
            levelCanvas.height = 200;
            levelCtx.clearRect(0, 0, levelCanvas.width, levelCanvas.height);

            // Dibujar marco
            levelCtx.beginPath();
            levelCtx.rect(20, 20, levelCanvas.width - 40, levelCanvas.height - 40);
            levelCtx.strokeStyle = '#000';
            levelCtx.stroke();

            // Dibujar c칤rculo central con cruceta
            levelCtx.beginPath();
            levelCtx.arc(levelCanvas.width / 2, levelCanvas.height / 2, 15, 0, Math.PI * 2);
            levelCtx.strokeStyle = '#000';
            levelCtx.stroke();
            levelCtx.beginPath();
            levelCtx.moveTo(levelCanvas.width / 2, levelCanvas.height / 2 - 20);
            levelCtx.lineTo(levelCanvas.width / 2, levelCanvas.height / 2 + 20);
            levelCtx.moveTo(levelCanvas.width / 2 - 20, levelCanvas.height / 2);
            levelCtx.lineTo(levelCanvas.width / 2 + 20, levelCanvas.height / 2);
            levelCtx.stroke();

            // Dibujar burbuja
            levelCtx.beginPath();
            levelCtx.arc(bubbleX, bubbleY, 10, 0, Math.PI * 2);
            levelCtx.fillStyle = 'rgba(0, 255, 0, 0.5)';
            levelCtx.fill();
            requestAnimationFrame(drawLevel);
        }

        window.addEventListener('deviceorientation', (e) => {
            const gamma = e.gamma || 0; // Left-right tilt
            const beta = e.beta || 0;   // Front-back tilt
            bubbleX = (levelCanvas.width / 2) + (gamma / 90) * (levelCanvas.width / 2 - 30);
            bubbleY = (levelCanvas.height / 2) + (beta / 90) * (levelCanvas.height / 2 - 30);
            bubbleX = Math.max(30, Math.min(levelCanvas.width - 30, bubbleX));
            bubbleY = Math.max(30, Math.min(levelCanvas.height - 30, bubbleY));
        });

        drawLevel();

        // Accelerometer Chart
        const accelChartCtx = document.getElementById('accelChart').getContext('2d');
        let accelData = { x: [], y: [], z: [], time: [], speed: [] };
        const accelChart = new Chart(accelChartCtx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [
                    { label: 'Eje X', data: [], borderColor: 'red', borderWidth: 1, fill: false, pointRadius: 0 },
                    { label: 'Eje Y', data: [], borderColor: 'green', borderWidth: 1, fill: false, pointRadius: 0 },
                    { label: 'Eje Z', data: [], borderColor: 'blue', borderWidth: 1, fill: false, pointRadius: 0 }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    x: { type: 'linear', min: 0, max: 2.5, title: { display: true, text: 'Tiempo (s)' } },
                    y: { title: { display: true, text: 'Aceleraci칩n (m/s)' } }
                },
                plugins: {
                    legend: { display: true, position: 'top' },
                    zoom: {
                        pan: { enabled: true, mode: 'x' },
                        zoom: {
                            pinch: { enabled: true },
                            mode: 'x',
                            onZoom: ({ chart }) => {
                                const { min, max } = chart.scales.x;
                                chart.options.scales.x.min = min;
                                chart.options.scales.x.max = max;
                                chart.update();
                            }
                        }
                    }
                }
            }
        });

        let isRecording = false;
        let startTime = 0;
        document.getElementById('startRecording').addEventListener('click', () => {
            if (!isRecording) {
                isRecording = true;
                startTime = performance.now();
                accelData = { x: [], y: [], z: [], time: [], speed: [] };
                document.getElementById('recordingStatus').textContent = 'Estado: Grabando';
                document.getElementById('startRecording').disabled = true;
                document.getElementById('stopRecording').disabled = false;
                recordAccelData();
            }
        });

        document.getElementById('stopRecording').addEventListener('click', () => {
            if (isRecording) {
                isRecording = false;
                document.getElementById('recordingStatus').textContent = 'Estado: No grabando';
                document.getElementById('startRecording').disabled = false;
                document.getElementById('stopRecording').disabled = true;
            }
        });

        function recordAccelData() {
            if (!isRecording) return;
            window.addEventListener('devicemotion', (e) => {
                if (!isRecording) return;
                const time = (performance.now() - startTime) / 1000;
                const accel = e.accelerationIncludingGravity || { x: 0, y: 0, z: 0 };
                accelData.x.push(accel.x || 0);
                accelData.y.push(accel.y || 0);
                accelData.z.push(accel.z || 0);
                accelData.time.push(time);
                accelData.speed.push(0); // Placeholder for speed
                accelChart.data.labels = accelData.time;
                accelChart.data.datasets[0].data = accelData.x;
                accelChart.data.datasets[1].data = accelData.y;
                accelChart.data.datasets[2].data = accelData.z;
                if (time > accelChart.options.scales.x.max) {
                    accelChart.options.scales.x.min += 0.1;
                    accelChart.options.scales.x.max += 0.1;
                }
                accelChart.update();
                document.getElementById('accelX').textContent = (accel.x || 0).toFixed(3);
                document.getElementById('accelY').textContent = (accel.y || 0).toFixed(3);
                document.getElementById('accelZ').textContent = (accel.z || 0).toFixed(3);
                document.getElementById('speed').textContent = '0';
            }, { once: true });
            requestAnimationFrame(recordAccelData);
        }

        // GPS Data
        let gpsPoints = 0;
        navigator.geolocation.watchPosition((pos) => {
            gpsPoints++;
            document.getElementById('gpsStatus').textContent = 'Estado GPS: 游늸 Conectado';
            document.getElementById('gpsCoords').textContent = `Coordenadas: ${pos.coords.latitude.toFixed(6)}, ${pos.coords.longitude.toFixed(6)}`;
            document.getElementById('gpsSpeed').textContent = `Velocidad GPS: ${(pos.coords.speed * 3.6 || 0).toFixed(1)} km/h`;
            document.getElementById('gpsAccuracy').textContent = `Precisi칩n GPS: ${pos.coords.accuracy.toFixed(1)} m`;
            document.getElementById('gpsPoints').textContent = `Puntos GPS: ${gpsPoints}`;
        }, () => {
            document.getElementById('gpsStatus').textContent = 'Estado GPS: 游늸 Error';
        }, { enableHighAccuracy: true });

        // Export Functions
        function exportToCSV(data, filename) {
            try {
                const csv = data.map(row => Object.values(row).join(',')).join('\n');
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
                URL.revokeObjectURL(url);
                console.log(`CSV ${filename} generado correctamente`);
            } catch (error) {
                console.error('Error al exportar CSV:', error);
                alert('Error al generar el CSV. Revisa la consola para m치s detalles.');
            }
        }

        document.getElementById('exportAccelCSV').addEventListener('click', () => {
            const data = accelData.time.map((t, i) => ({
                Time: t.toFixed(3),
                X: accelData.x[i].toFixed(3),
                Y: accelData.y[i].toFixed(3),
                Z: accelData.z[i].toFixed(3),
                Speed: accelData.speed[i].toFixed(3)
            }));
            exportToCSV(data, 'accelerometer_data.csv');
        });

        document.getElementById('exportGPSCSV').addEventListener('click', () => {
            const data = [{ id: '1', lat: 'N/A', lon: 'N/A', speed: '0', accuracy: 'N/A' }];
            exportToCSV(data, 'gps_data.csv');
        });

        document.getElementById('exportPDF').addEventListener('click', () => {
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                doc.setFont('Helvetica', 'normal');
                doc.text('Informe de An치lisis de Frenos', 20, 20);
                const img = new Image();
                img.crossOrigin = 'Anonymous';
                img.src = 'https://aivan84.github.io/analisis-frenos/icon.png?cache=' + new Date().getTime();
                img.onload = () => {
                    try {
                        doc.addImage(img, 'PNG', 20, 30, 30, 10);
                    } catch (imgError) {
                        console.warn('No se pudo a침adir la imagen al PDF:', imgError);
                        doc.text('No se pudo cargar el logo', 20, 40);
                    }
                    doc.text(`Diligencias: ${document.getElementById('diligenciasMu').value || 'N/A'}`, 20, 50);
                    doc.text(`Matr칤cula: ${document.getElementById('matriculaMu').value || 'N/A'}`, 20, 60);
                    doc.text(`풮 Autom치tico: ${document.getElementById('muAuto').textContent}`, 20, 70);
                    doc.text(`풮 Manual: ${document.getElementById('muManual').textContent}`, 20, 80);
                    doc.save('informe_frenos.pdf');
                    document.getElementById('dataHash').textContent = 'hash-placeholder';
                    console.log('PDF generado correctamente');
                };
                img.onerror = () => {
                    console.warn('No se pudo cargar la imagen para el PDF');
                    doc.text('No se pudo cargar el logo', 20, 40);
                    doc.text(`Diligencias: ${document.getElementById('diligenciasMu').value || 'N/A'}`, 20, 50);
                    doc.text(`Matr칤cula: ${document.getElementById('matriculaMu').value || 'N/A'}`, 20, 60);
                    doc.text(`풮 Autom치tico: ${document.getElementById('muAuto').textContent}`, 20, 70);
                    doc.text(`풮 Manual: ${document.getElementById('muManual').textContent}`, 20, 80);
                    doc.save('informe_frenos.pdf');
                    document.getElementById('dataHash').textContent = 'hash-placeholder';
                    console.log('PDF generado sin imagen');
                };
            } catch (error) {
                console.error('Error al generar PDF:', error);
                alert('Error al generar el PDF. Revisa la consola para m치s detalles.');
            }
        });

        document.getElementById('exportExcel').addEventListener('click', () => {
            try {
                const data = [
                    ['Diligencias', document.getElementById('diligenciasMu').value || 'N/A'],
                    ['Matr칤cula', document.getElementById('matriculaMu').value || 'N/A'],
                    ['풮 Autom치tico', document.getElementById('muAuto').textContent],
                    ['풮 Manual', document.getElementById('muManual').textContent],
                    [],
                    ['Tiempo (s)', 'Eje X', 'Eje Y', 'Eje Z', 'Velocidad'],
                    ...accelData.time.map((t, i) => [
                        t.toFixed(3),
                        accelData.x[i].toFixed(3),
                        accelData.y[i].toFixed(3),
                        accelData.z[i].toFixed(3),
                        accelData.speed[i].toFixed(3)
                    ])
                ];
                const ws = XLSX.utils.aoa_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'Informe');
                XLSX.writeFile(wb, 'informe_frenos.xlsx');
                document.getElementById('dataHash').textContent = 'hash-placeholder';
                console.log('Excel generado correctamente');
            } catch (error) {
                console.error('Error al generar Excel:', error);
                alert('Error al generar el Excel. Revisa la consola para m치s detalles.');
            }
        });

        // Reaction Time Test
        document.getElementById('startReactionTest').addEventListener('click', () => {
            try {
                const lights = [document.getElementById('light1'), document.getElementById('light2')];
                lights.forEach(light => light.classList.add('bg-red-500'));
                const delay = Math.random() * 3000 + 1000;
                setTimeout(() => {
                    lights.forEach(light => light.classList.remove('bg-red-500'));
                    const startTime = performance.now();
                    const handler = () => {
                        const reactionTime = (performance.now() - startTime) / 1000;
                        alert(`Tiempo de reacci칩n: ${reactionTime.toFixed(3)} segundos`);
                        document.removeEventListener('click', handler);
                    };
                    document.addEventListener('click', handler, { once: true });
                }, delay);
                console.log('Ensayo de reacci칩n iniciado');
            } catch (error) {
                console.error('Error en el ensayo de reacci칩n:', error);
                alert('Error al iniciar el ensayo de reacci칩n. Revisa la consola.');
            }
        });

        document.getElementById('exportReactionPDF').addEventListener('click', () => {
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                doc.setFont('Helvetica', 'normal');
                doc.text('Informe de Tiempo de Reacci칩n', 20, 20);
                const img = new Image();
                img.crossOrigin = 'Anonymous';
                img.src = 'https://aivan84.github.io/analisis-frenos/icon.png?cache=' + new Date().getTime();
                img.onload = () => {
                    try {
                        doc.addImage(img, 'PNG', 20, 30, 30, 10);
                    } catch (imgError) {
                        console.warn('No se pudo a침adir la imagen al PDF:', imgError);
                        doc.text('No se pudo cargar el logo', 20, 40);
                    }
                    doc.text(`Diligencias: ${document.getElementById('diligenciasReaction').value || 'N/A'}`, 20, 50);
                    doc.text(`Matr칤cula: ${document.getElementById('matriculaReaction').value || 'N/A'}`, 20, 60);
                    doc.save('informe_reaccion.pdf');
                    document.getElementById('reactionHash').textContent = 'hash-placeholder';
                    console.log('PDF de reacci칩n generado correctamente');
                };
                img.onerror = () => {
                    console.warn('No se pudo cargar la imagen para el PDF');
                    doc.text('No se pudo cargar el logo', 20, 40);
                    doc.text(`Diligencias: ${document.getElementById('diligenciasReaction').value || 'N/A'}`, 20, 50);
                    doc.text(`Matr칤cula: ${document.getElementById('diligenciasReaction').value || 'N/A'}`, 20, 60);
                    doc.save('informe_reaccion.pdf');
                    document.getElementById('reactionHash').textContent = 'hash-placeholder';
                    console.log('PDF de reacci칩n generado sin imagen');
                };
            } catch (error) {
                console.error('Error al generar PDF de reacci칩n:', error);
                alert('Error al generar el PDF de reacci칩n. Revisa la consola.');
            }
        });

        document.getElementById('exportReactionExcel').addEventListener('click', () => {
            try {
                const data = [
                    ['Diligencias', document.getElementById('diligenciasReaction').value || 'N/A'],
                    ['Matr칤cula', document.getElementById('matriculaReaction').value || 'N/A'],
                    ['Tiempo de Reacci칩n', 'N/A'] // Placeholder
                ];
                const ws = XLSX.utils.aoa_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'Informe Reacci칩n');
                XLSX.writeFile(wb, 'informe_reaccion.xlsx');
                document.getElementById('reactionHash').textContent = 'hash-placeholder';
                console.log('Excel de reacci칩n generado correctamente');
            } catch (error) {
                console.error('Error al generar Excel de reacci칩n:', error);
                alert('Error al generar el Excel de reacci칩n. Revisa la consola.');
            }
        });

        document.getElementById('understood').addEventListener('click', () => {
            alert('춰Entendido!');
        });
    </script>
</body>
</html>